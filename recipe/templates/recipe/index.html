{% extends 'recipe/base.html' %}

{% block style %}

<style>
.card {
  width: 28%;
  margin: 20px;
  height: 200px;
  background-color: transparent;
  object-fit: cover;
}
.card.active {
  height: auto;
  width: auto;
}
.card img {
  height: 100%;
  width: 100%;
}
.containerbody {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.btns {
  display: flex;
  flex-direction: row;
  justify-items: center;
  width: 400px;
  margin: 10px;
}
.btns #reload {
  margin-left: 3rem;
  display: none;
}
.btns .times-x {
  width: 80%;
  margin-left: 2rem;
  display: flex;
  flex-direction: row;
  justify-content: center;
}

button {
  width: 50px;
  height: 30px;
  background-color: bisque;
  color: #000;
  border-radius: 5px;
  border: 1px solid #fab62d;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.7);
  margin: 5px;
  font-size: 17px;
  overflow: none;
  font-weight: bold;
}

@media screen and (max-width: 800px) {
  .card {
    width: 50%;
  }
}

</style>

{% endblock %}

{% block body %}

        {% for d in data %}
        {% if d.image %}
        <div class="card">
           <img src="{{d.image}}" alt="{{d.title}}">
       </div>
        {% endif %} 
        <div class="recipe" >
            <h3 id="title">{{d.title}}</h3>
             <br><br>
             <ul class="original">
                {% for i in ing  %}
                 <li>{{i}}</li>
                {% endfor %}
             </ul>
             <br><br>
             {% if user.is_staff %}
             <a href="{% url 'delete' d.title %}" id="original">Delete Recipe</a>
             {% endif %}
         </div>
         {% if subrecipe %}
         <div class="recipe" style="margin-top:10px;">
            <h3>{{d.title}} Sub Recipe</h3>
             <br><br>
             <ul>
                {% for j in subrecipe %}
                <li><a href="{% url 'subrecipe' d.id j.title  %}">{{j.title}}</a></li>
                {% endfor %}
             </ul>
         </div>
         {% endif %}
         <br>
         <h3>Multiply recipe by:</h3>
         <div class="btns">
             <button value="1" id="reload">x 1 </button>
             <div class="times-x">
             <button value="1.5"> x 1 Â½ </button>
             <button value="2" > x 2 </button>
             <button value="3">x 3 </button>
             <button value="4">x 4 </button>
            </div>
         </div>

         {% if d.method %}
         <div class="method">
             <h3>Method</h3>
             <p>{{d.method}}</p>
             <br><br>
             <p><a href="{% url 'index' %}">Return Back</a></p>
         </div>

         {% endif %}
         {% endfor %}

         <script>
             const image = document.querySelector('.card')
if(image) {

image.addEventListener('click', () => {
   
   if (image.classList == 'card') {
           image.classList.add('active')
   } else {
       image.classList.remove('active')
   }

    
})
}   

const data = document.querySelector('.recipe')
let dataText = []
const i = data.innerText.split('\n')
const btns = document.querySelectorAll('button') 

btns.forEach((btn) => {

   btn.addEventListener('click', ()=>{
           const times = btn.value
           //console.log(times)
       if (times === '1') {
           window.location.reload(true)
           return false
       } else {
           i.forEach((e) => {
               var num = e.split(/\s+/)

               num.forEach((b) => {
                   if(isNaN(b)){

                   } else {
                   let c = b * times
                   const tmp = num[0]
                   num[0] =  Math.floor(c) 
                                           
                   }
                   
                   
               })
                       e = num
                       const tmp = e.join(' ')
                       
                       //console.log(tmp)
                       const li = document.createElement('li')
                       const original = document.querySelector('.original')
                      // const linkOriginal = document.getElementById('original')
                       li.style.display = 'block'
                       dataText.push(li)
                       if (tmp === '0') {
                           li.innerHTML = ''
                           
                       } else  {
                           
                           
                           
                           original.style.display = 'none'
                           //linkOriginal.style.display = 'none'
                           document.getElementById('title').style.display = 'none'

                           li.innerHTML =`${tmp}`
                           console.log(tmp[0][0])
                       }
                       data.appendChild(li)
                       document.querySelector('.times-x').style.display = 'none'
                       document.getElementById('reload').style.display = 'block'

       })}

   })
   
})

         </script>

{% endblock %}   